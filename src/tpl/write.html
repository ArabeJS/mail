<div class="lightbox-body" ng-controller="WriteCtrl">
  <header>
    <h2>{{writerTitle}}</h2>
    <button class="close" ng-click="state.writer.close()" data-action="lightbox-close">&#xe007;</button>
  </header>
  <div class="content">

    <div class="view-write">
      <div class="headers">
        <p field="to">
          <span>To:</span>
          <span ng-repeat="recipient in to track by $index">
            <input id="to{{$index}}" value="{{recipient.address}}" ng-model="recipient.address" ng-trim="false" ng-class="{'label': recipient.secure === true, 'label label-primary': recipient.secure === false && recipient.valid !== true}" auto-size="recipient.address" spellcheck="false" ng-change="onAddressUpdate(to, $index)" address-input="to" tabindex="1" ng-mouseover="getKeyId(recipient)" focus-me="state.writer.open && writerTitle !== 'Reply'">
          </span>
        </p>
        <p field="cc">
          <span>Cc:</span>
          <span ng-repeat="recipient in cc track by $index">
            <input id="cc{{$index}}" value="{{recipient.address}}" ng-model="recipient.address" ng-trim="false" ng-class="{'label': recipient.secure === true, 'label label-primary': recipient.secure === false && recipient.valid !== true}" auto-size="recipient.address" spellcheck="false" ng-change="onAddressUpdate(cc, $index)" address-input="cc" tabindex="1" ng-mouseover="getKeyId(recipient)">
          </span>
        </p>
      </div><!--/.address-headers-->

      <div class="subject-box">
        <div class="subject-line">
          <input ng-model="subject" class="subject" spellcheck="true" tabindex="2" placeholder="Subject" ng-change="updatePreview()">
        </div><!--/.subject-line-->
        <input id="attachment-input" type="file" multiple attachment-input>
        <button class="btn-attachment" attachment-btn>
          <div data-icon="&#xe003;"></div>
        </button><!--/.btn-attachment-->
      </div><!--/.subject-box-->

      <div ng-switch="attachments.length > 0">
        <div ng-switch-when="true">
          <div class="attachments-box">
            <span ng-repeat="attachment in attachments" class="attachment">
              <span data-icon="&#xe003;"></span>
              {{attachment.filename}}
              <span class="close" data-icon="&#xe000;" ng-click="remove(attachment)"></span>
            </span><!--/.attachment-->
          </div><!--/.attachments-box-->
        </div><!--/ng-switch-when-->
      </div><!--/ng-switch-->

      <div class="body" focus-child>
        <p ng-model="body" contentEditable="true" spellcheck="false" ng-change="updatePreview()" tabindex="3" focus-me="state.writer.open && writerTitle === 'Reply'"></p>

        <div class="encrypt-preview" ng-class="{'invisible': !ciphertextPreview}">
          <p>-----BEGIN ENCRYPTED PREVIEW-----<br>{{ciphertextPreview}}<br>-----END ENCRYPTED PREVIEW-----</p>
        </div><!--/.encrypt-preview-->
      </div><!--/.body-->

      <div class="send-control">
        <button ng-click="sendToOutbox()" class="btn" data-icon="{{(sendBtnSecure === false) ? '&#xe001;' : (sendBtnSecure === true) ? '&#xe009;' : ''}}" ng-disabled="!okToSend" tabindex="4">{{sendBtnText || 'Send'}}</button>
      </div>
    </div><!--/.write-view-->

  </div><!--/.content-->

  <!-- popovers -->
  <div id="fingerprint-writer" class="popover right" ng-controller="PopoverCtrl">
    <div class="arrow"></div>
    <div class="popover-title"><b>PGP key ID</b></div>
    <div class="popover-content">{{keyId}}</div>
  </div><!--/.popover-->
</div><!--/.lightbox-body-->